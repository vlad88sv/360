<ifModule mod_gzip.c>
  mod_gzip_on Yes
  mod_gzip_dechunk Yes
  mod_gzip_item_include file \.(html?|txt|css|js|pl)$
  mod_gzip_item_include mime ^text/.*
  mod_gzip_item_include mime ^application/x-javascript.*
  mod_gzip_item_exclude mime ^image/.*
  mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</ifModule>

#
### turn on the Expires engine
#
<ifModule mod_expires.c>
ExpiresActive On

### expires after a month in the client's cache
ExpiresByType image/gif A2592000
ExpiresByType image/png A2592000
ExpiresByType image/jpg A2592000
ExpiresByType image/x-icon A2592000
ExpiresByType application/pdf A2592000
ExpiresByType application/x-javascript A2592000
ExpiresByType text/plain A2592000
ExpiresByType text/css A2592000
</ifModule>

<ifModule mod_headers.c>
  <filesMatch "\\.(ico|pdf|flv|jpg|jpeg|png|gif|swf)$">
    Header set Cache-Control "max-age=2592000, public"
  </filesMatch>
  <filesMatch "\\.(css)$">
    Header set Cache-Control "max-age=604800, public"
  </filesMatch>
  <filesMatch "\\.(js)$">
    Header set Cache-Control "max-age=216000, private"
  </filesMatch>
  <filesMatch "\\.(xml|txt)$">
    Header set Cache-Control "max-age=216000, public, must-revalidate"
  </filesMatch>
  <filesMatch "\\.(html|htm|php)$">
    Header set Cache-Control "max-age=1, private, must-revalidate"
  </filesMatch>
</ifModule>

RewriteEngine on
Options +FollowSymLinks

RewriteBase /

RewriteRule ^(iniciar|finalizar|registrar|buscar|~usuarios|~contenedores|~variedades|~categorias|~accesorios|~productos_categoria|~filtros|~menu|~administracion|~compras|~estadisticas|~massmail|informacion|ventas|ayuda|editar|verificar|contactanos)$ index.php?peticion=$1&%{QUERY_STRING} [L]
RewriteRule ^comprar-articulo-.*$ index.php?peticion=comprar [L]
RewriteRule ^vitrina-(.*)-([0-9]+).*$ index.php?peticion=vitrina&titulo=$1&codigo_contenedor=$2 [L]
RewriteRule ^categoria-superior-.*-([0-9]+).*$ index.php?peticion=categoria&modo=superior&codigo_categoria=$1&%{QUERY_STRING} [L]
RewriteRule ^categoria-(.+)-especial.*$ index.php?peticion=categoria&modo=filtro&codigo_categoria=$1&%{QUERY_STRING} [L]
RewriteRule ^categoria-.*-([0-9]+).*$ index.php?peticion=categoria&codigo_categoria=$1&%{QUERY_STRING} [L]
RewriteRule ^ajax$ ajax.php?%{QUERY_STRING} [L]

RewriteCond %{REQUEST_URI} ^/imagen_([0-9]+)_([0-9]+)_([a-za-z0-9]{40})(\.jpg){0,1}$
RewriteCond %{DOCUMENT_ROOT}/IMG/i/m/%1_%2_%3 -f [NC]
RewriteRule ^imagen_([0-9]+)_([0-9]+)_([a-za-z0-9]{40}).*$ %{DOCUMENT_ROOT}/IMG/i/m/$1_$2_$3 [L]

RewriteRule ^imagen_([0-9]+)_([0-9]+)_(.*)$ imagen.php?tipo=normal&ancho=$1&alto=$2&sha1=$3 [L]
RewriteRule ^imagen_SSL_(.*)$ imagen.php?tipo=tcredito&pin=$1 [L]
RewriteRule ^admin_(.+)$ index.php?peticion=admin&op=$1&%{QUERY_STRING} [L]
RewriteRule ^registro_(.+)_existe:(.*)$ PHP/traductor.php?peticion=registro_usuarios_$1&op=$2 [L]
